<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Transmitter - Robotics Workshop</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Transmitter";
        var mkdocs_page_input_path = "06_Drive\\transmitter_code.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Robotics Workshop
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../00_Getting_started/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Arduino</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../00_Getting_started/Arduino/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../00_Getting_started/Arduino/serial_print/">Serial Print</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../00_Getting_started/Arduino/serial_plotter/">Serial Plotter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../00_Getting_started/Arduino/serial_input/">Serial Input</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../00_Getting_started/Arduino/putting_everything_together/">Putting everything together</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../00_Getting_started/LEDs/">LEDs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Sensors</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../01_Sensors/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Distance</a>
    <ul>
                <li class="toctree-l2"><a class="" href="../../01_Sensors/Distance/ultraschall/README.md">Ultrasonic</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../01_Sensors/Distance/VL53L0X_ToF/">VL53L0X ToF</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >IMU</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../01_Sensors/MPU_6050/">MPU 6050</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Actuators</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../02_Actuators/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../02_Actuators/motor_driver/">Motor Driver</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../03_Power/">Power</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Communication</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../04_Communication/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Protocols</a>
    <ul>
                <li class="toctree-l2"><a class="" href="../../04_Communication/I2C/README.md">I2C</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >nRF</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../04_Communication/nRF/">Overview</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../04_Communication/remote/">Remote</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Assembly</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../05_Assembly/receiver/">Receiver</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../05_Assembly/transmitter/">Transmitter</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Drive</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../receiver_code/">Receiver</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Transmitter</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#components-used">Components Used</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#libraries-included">Libraries Included</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pin-definitions">Pin Definitions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#objects-and-variables">Objects and Variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#setup-function">Setup Function</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#wire-and-serial-initialization">Wire and Serial Initialization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#nrf24l01-initialization">nRF24L01 Initialization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#debugging-information">Debugging Information</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mpu6050-initialization">MPU6050 Initialization</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#loop-function">Loop Function</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#reading-sensor-data">Reading Sensor Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#transmitting-data">Transmitting Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#debugging-information_1">Debugging Information</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#loop-delay">Loop Delay</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#full-code">Full code:</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Transition to Drone</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../07_Robo_Drone/">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Outlook</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../08_Outlook/">Overview</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Robotics Workshop</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Drive</li>
      <li class="breadcrumb-item active">Transmitter</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="explanation-of-the-transmitter-code">Explanation of the Transmitter Code<a class="headerlink" href="#explanation-of-the-transmitter-code" title="Permanent link">&para;</a></h1>
<p>This document provides a detailed explanation of the transmitter code used to send data from an Arduino Nano with an MPU6050 sensor using the nRF24L01 module.</p>
<h2 id="components-used">Components Used<a class="headerlink" href="#components-used" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Arduino Nano</strong></li>
<li><strong>nRF24L01</strong> Transceiver Module</li>
<li><strong>MPU6050</strong> Accelerometer and Gyroscope Sensor</li>
<li><strong>Breadboard and jumper wires</strong></li>
</ul>
<h2 id="libraries-included">Libraries Included<a class="headerlink" href="#libraries-included" title="Permanent link">&para;</a></h2>
<ul>
<li><code>SPI.h</code>: For SPI communication with the nRF24L01 module</li>
<li><code>printf.h</code>: For debugging the nRF24L01</li>
<li><code>RF24.h</code>: For controlling the nRF24L01 transceiver</li>
<li><code>Wire.h</code>: For I2C communication with the MPU6050 sensor</li>
<li><code>Adafruit_Sensor.h</code>: For sensor abstraction</li>
<li><code>Adafruit_MPU6050.h</code>: For controlling the MPU6050 sensor</li>
</ul>
<h2 id="pin-definitions">Pin Definitions<a class="headerlink" href="#pin-definitions" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>CE_PIN</strong>: Pin connected to the CE pin of the nRF24L01 (D7)</li>
<li><strong>CSN_PIN</strong>: Pin connected to the CSN pin of the nRF24L01 (D8)</li>
</ul>
<h2 id="objects-and-variables">Objects and Variables<a class="headerlink" href="#objects-and-variables" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>data</strong>: Array to hold the X and Y axis data to be transmitted</li>
<li><strong>address</strong>: Array to hold the addresses for the nRF24L01 communication</li>
<li><strong>radio</strong>: Object for the nRF24L01 transceiver</li>
<li><strong>mpu</strong>: Object for the MPU6050 sensor</li>
<li><strong>radioNumber</strong>: Boolean to determine if the device is transmitting or receiving (0 for transmitting, 1 for receiving)</li>
</ul>
<h2 id="setup-function">Setup Function<a class="headerlink" href="#setup-function" title="Permanent link">&para;</a></h2>
<h3 id="wire-and-serial-initialization">Wire and Serial Initialization<a class="headerlink" href="#wire-and-serial-initialization" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">Wire</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Custom Transmitter running:&quot;</span><span class="p">));</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;By Tim Schumann&quot;</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;radioNumber = &quot;</span><span class="p">));</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">radioNumber</span><span class="p">);</span>
</code></pre></div>

<ul>
<li>Initializes the I2C bus for the MPU6050 sensor.</li>
<li>Starts the serial communication for debugging purposes.</li>
</ul>
<h3 id="nrf24l01-initialization">nRF24L01 Initialization<a class="headerlink" href="#nrf24l01-initialization" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">radio</span><span class="p">.</span><span class="n">begin</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;radio hardware is not responding!!&quot;</span><span class="p">));</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>

<span class="n">radio</span><span class="p">.</span><span class="n">setPALevel</span><span class="p">(</span><span class="n">RF24_PA_LOW</span><span class="p">);</span>
<span class="n">radio</span><span class="p">.</span><span class="n">setPayloadSize</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
<span class="n">radio</span><span class="p">.</span><span class="n">openWritingPipe</span><span class="p">(</span><span class="n">address</span><span class="p">[</span><span class="n">radioNumber</span><span class="p">]);</span>
<span class="n">radio</span><span class="p">.</span><span class="n">stopListening</span><span class="p">();</span>
</code></pre></div>

<ul>
<li>Initializes the nRF24L01 transceiver, sets power level, payload size, and opens the writing pipe for transmitting data.</li>
</ul>
<h3 id="debugging-information">Debugging Information<a class="headerlink" href="#debugging-information" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">printf_begin</span><span class="p">();</span>
<span class="n">radio</span><span class="p">.</span><span class="n">printPrettyDetails</span><span class="p">();</span>
</code></pre></div>

<ul>
<li>Initializes the printf debugging and prints detailed information about the nRF24L01 module.</li>
</ul>
<h3 id="mpu6050-initialization">MPU6050 Initialization<a class="headerlink" href="#mpu6050-initialization" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mpu</span><span class="p">.</span><span class="n">begin</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Failed to find MPU6050 chip&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<ul>
<li>Initializes the MPU6050 sensor. If the sensor is not found, the program enters an infinite loop.</li>
</ul>
<h2 id="loop-function">Loop Function<a class="headerlink" href="#loop-function" title="Permanent link">&para;</a></h2>
<h3 id="reading-sensor-data">Reading Sensor Data<a class="headerlink" href="#reading-sensor-data" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">sensors_event_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="n">mpu</span><span class="p">.</span><span class="n">getEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span>

<span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="mf">-10.0</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">acceleration</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="mf">-10.0</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">acceleration</span><span class="p">.</span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</code></pre></div>

<ul>
<li>Reads the acceleration data from the MPU6050 sensor and scales it to fit within the range of -100 to 100.</li>
</ul>
<h3 id="transmitting-data">Transmitting Data<a class="headerlink" href="#transmitting-data" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start_timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">micros</span><span class="p">();</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">radio</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">end_timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">micros</span><span class="p">();</span>
</code></pre></div>

<ul>
<li>Transmits the data using the nRF24L01 module and measures the time taken for transmission.</li>
</ul>
<h3 id="debugging-information_1">Debugging Information<a class="headerlink" href="#debugging-information_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Transmission successful! &quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Time to transmit = &quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">end_timer</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_timer</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot; us. Sent: &quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; : &quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Transmission failed or timed out&quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">printPrettyDetails</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<ul>
<li>If the transmission is successful, it prints the time taken and the transmitted data. If the transmission fails, it prints an error message.</li>
</ul>
<h3 id="loop-delay">Loop Delay<a class="headerlink" href="#loop-delay" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</code></pre></div>

<ul>
<li>Adds a delay of 10 milliseconds to slow down the transmission rate.</li>
</ul>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>This code reads acceleration data from an MPU6050 sensor and transmits it using an nRF24L01 module. The setup and loop functions handle the initialization and continuous data transmission, respectively. Debugging information is printed to the Serial Monitor to assist in monitoring the system's operation.</p>
<h2 id="full-code">Full code:<a class="headerlink" href="#full-code" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SPI.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;printf.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;RF24.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Wire.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Adafruit_Sensor.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Adafruit_MPU6050.h&gt;</span>


<span class="cp">#define CE_PIN 7</span>
<span class="cp">#define CSN_PIN 8</span>

<span class="c1">//Define packet for the direction (X axis and Y axis)</span>
<span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

<span class="c1">// Let these addresses be used for the pair</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">address</span><span class="p">[][</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;1Trans&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1Rec&quot;</span><span class="w"> </span><span class="p">};</span>

<span class="c1">// instantiate an object for the nRF24L01 transceiver</span>
<span class="n">RF24</span><span class="w"> </span><span class="nf">radio</span><span class="p">(</span><span class="n">CE_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">CSN_PIN</span><span class="p">);</span>

<span class="c1">// Create a BME280 object</span>
<span class="n">Adafruit_MPU6050</span><span class="w"> </span><span class="n">mpu</span><span class="p">;</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">radioNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// 0 uses address[0] to transmit, 1 uses address[1] to receive</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Wire</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>

<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// print example&#39;s introductory prompt</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Custom Transmitter running:&quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;By Tim Schumann&quot;</span><span class="p">);</span>


<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;radioNumber = &quot;</span><span class="p">));</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">radioNumber</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// initialize the transceiver on the SPI bus</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">radio</span><span class="p">.</span><span class="n">begin</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;radio hardware is not responding!!&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">  </span><span class="c1">// hold in infinite loop</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Set the PA Level low to try preventing power supply related problems</span>
<span class="w">  </span><span class="c1">// because these examples are likely run with nodes in close proximity to</span>
<span class="w">  </span><span class="c1">// each other.</span>
<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">setPALevel</span><span class="p">(</span><span class="n">RF24_PA_LOW</span><span class="p">);</span><span class="w">  </span><span class="c1">// RF24_PA_MAX is default.</span>

<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">setPayloadSize</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span><span class="w">  </span><span class="c1">// float datatype occupies 4 bytes</span>

<span class="w">  </span><span class="c1">// set the TX address of the RX node into the TX pipe</span>
<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">openWritingPipe</span><span class="p">(</span><span class="n">address</span><span class="p">[</span><span class="n">radioNumber</span><span class="p">]);</span><span class="w">  </span><span class="c1">// always uses pipe 0</span>

<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">stopListening</span><span class="p">();</span><span class="w">  </span><span class="c1">// put radio in TX mode</span>

<span class="w">  </span><span class="c1">// For debugging info</span>
<span class="w">  </span><span class="n">printf_begin</span><span class="p">();</span><span class="w">              </span><span class="c1">// needed only once for printing details</span>
<span class="w">  </span><span class="n">radio</span><span class="p">.</span><span class="n">printPrettyDetails</span><span class="p">();</span><span class="w">  </span><span class="c1">// (larger) function that prints human readable data</span>


<span class="w">  </span><span class="c1">//start mpu</span>
<span class="w">  </span><span class="c1">// Try to initialize!</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mpu</span><span class="p">.</span><span class="n">begin</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Failed to find MPU6050 chip&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="cm">/* Get new sensor events with the readings */</span>
<span class="w">  </span><span class="n">sensors_event_t</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="w">  </span><span class="n">mpu</span><span class="p">.</span><span class="n">getEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span>

<span class="w">  </span><span class="cm">/*Serial.print(&quot;Acceleration X: &quot;);</span>
<span class="cm">  Serial.print(a.acceleration.x);</span>
<span class="cm">  Serial.print(&quot;, Y: &quot;);</span>
<span class="cm">  Serial.print(a.acceleration.y);</span>
<span class="cm">  Serial.println(&quot; m/s^2&quot;);</span>
<span class="cm">*/</span>

<span class="w">  </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="mf">-10.0</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">acceleration</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">  </span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="mf">-10.0</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">acceleration</span><span class="p">.</span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>

<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start_timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">micros</span><span class="p">();</span><span class="w">            </span><span class="c1">// start the timer</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">radio</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span><span class="w">  </span><span class="c1">// transmit &amp; save the report</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">end_timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">micros</span><span class="p">();</span><span class="w">              </span><span class="c1">// end the timer</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*Serial.print(F(&quot;Transmission successful! &quot;));  // payload was delivered</span>
<span class="cm">    Serial.print(F(&quot;Time to transmit = &quot;));</span>
<span class="cm">    Serial.print(end_timer - start_timer);  // print the timer result</span>
<span class="cm">    Serial.print(F(&quot; us. Sent: &quot;));</span>
<span class="cm">    Serial.print(data[0]);  // print payload sent</span>
<span class="cm">    Serial.print(&quot; : &quot;);</span>
<span class="cm">    Serial.println(data[1]);*/</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//Serial.println(F(&quot;Transmission failed or timed out&quot;));  // payload was not delivered</span>
<span class="w">    </span><span class="c1">//radio.printPrettyDetails();                             // (larger) function that prints human readable data</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// to make this example readable in the serial monitor</span>
<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">  </span><span class="c1">// slow transmissions down by 1 second</span>
<span class="p">}</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../receiver_code/" class="btn btn-neutral float-left" title="Receiver"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../07_Robo_Drone/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../receiver_code/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../07_Robo_Drone/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
